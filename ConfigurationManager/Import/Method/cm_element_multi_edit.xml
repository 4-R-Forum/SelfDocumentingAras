<AML>
 <Item type="Method" id="E765372F54F74C5C9141749CB4FD518A" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA[
debugger;
//this is the method for an itemtype Action, which will run only once
// first check that method is being run from an ItemWindow
// and the parent item is locked
var win =top.aras.uiFindWindowEx(parent.itemID);
if(!win.relationships) {top.aras.AlertError("Please open a Configuration Manager for this action"); return;}
if(!(top.aras.isLockedByUser(parent.item)||parent.item.getAttribute("isNew")==="1")) 
 {top.aras.AlertError("Please Lock Configuration Manager for this action"); return;}
var selTabId = win.relationships.relTabbar.GetSelectedTab();
var grid = win.relationships.iframesCollection[selTabId].contentWindow.gridApplet;
// var tabbar = win.relationships.relTabbar ;
// get selected Items
var el_ids=grid.getSelectedItemIds();



// // we need to find which rows are selected and pass this to the form to be opened
// // navigating to the correct grid is a bit ugly
// var relTabId="DE00F47CC7A54498A8020C1E7668A8B6";
// var grid = parent.relationships.iframesCollection[relTabId].contentWindow.gridApplet;
// // var el_iframe=top.relationships.iframesCollection.F8E22ED9470740B19A4E9DA2EB75B9DA;
// // var grid=el_iframe.contentWindow.grid;
// var el_ids=grid.getSelectedItemIds(',');
// create an Item to pass properties to form
var values = this.newItem("ConfigurationElement");
values.setProperty("source_id",parent.item.getAttribute("id"));
if (el_ids)
{
 values.setProperty("el_ids",el_ids);
}
else
{
  top.aras.AlertError("No lines selected");
  return;
}
// create an object to pass values required by ShowFormAsADialog.html
var param = new Object();
param.title  = "Configuration Multi Line Edit"; // to be shown in the blue bar at top of window
param.formId = '08772C88C0CD422CAA4756A92FA5760F'; // the id of the Form to be used
param.item = values ; // an Item of valid type, can be used to populate the Form
param.aras = top.aras; // the aras object
param.mbom_ids=el_ids;// comma separated list of mbom ids
param.grid=grid;
// again this is an itemtype Action so the context Item is empty
// but we can get find the CM id, which we neeed to pass to the Form, as follows
param.source_id=parent.item.getAttribute("id"); // id of Part

var win = top.aras.getMostTopWindowWithAras(window);
top.aras.modalDialogHelper.show("DefaultPopup", win, param, { dialogWidth: 400, dialogHeight: 200 },"ShowFormAsADialog.html");


return this;]]></method_code>
  <method_type>JavaScript</method_type>
  <name>cm_element_multi_edit</name>
 </Item>
</AML>