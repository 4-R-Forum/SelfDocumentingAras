<AML>
 <Item type="Method" id="26B9003D7E7D499D96A110BAD9275AED" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA[// the context Item is the cm item passedby loadClientUpgradeAndEval as an Aras.IOM.Item 

var innov=this.getInnovator();
var export_folder=this.getProperty("export_folder");
var cu=document.clientUpgrade;
var base_url=top.aras.getServerURL();
var db=top.aras.getDatabase();
var user="root";
var pw="innovator";
var vault=top.aras.vault;
var mf_text="";

cu.login(base_url,db,user,pw,export_folder);
var xp="//Item[@type='ConfigurationElement'][do_export='1']";
var export_items=this.getItemsByXPath(xp);
for (var i=0;i<export_items.getItemCount();i++)
{
    var this_el=export_items.getItemByIndex(i);
    var this_package=this_el.getProperty("package_definition");
    var this_id=this_el.getProperty("element_id");
    var this_group=this_el.getProperty("package_group");
	var this_pd_folder=this_package.replace("com.aras.innovator.solution.","");
	var this_item=innov.getItemById(this_group,this_id);
	var this_kn=this_item.getProperty("keyed_name");
	var this_folder=export_folder+"\\"+this_pd_folder+"\\Import\\";
	cu.setfolder(this_folder);
	cu.packageItem(this_id, this_kn, this_group, this_package );
	if (mf_text.indexOf(this_package)<0)
	{ 
	   mf_text+=" <package name='"+this_package+"' path='"+this_pd_folder+"\\Import\\' />\r\n";
	}
}

mf_text="<imports>\r\n"+mf_text+"</imports>\r\n";
ok = vault.WriteText(export_folder+"\\imports.mf",mf_text);
if (!ok) { top.aras.AlertError("Error writing file manifest file");}
var msg=" Selected items exported successfully";
top.aras.AlertSuccess(msg);


]]></method_code>
  <method_type>JavaScript</method_type>
  <name>cm_export_selected</name>
 </Item>
</AML>